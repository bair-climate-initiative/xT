{
  "network": "EncoderDecoder",
  "encoder_params": {
    "encoder": "vit_base_patch16",
    "in_chans": 2,
    "drop_path_rate": 0.2,
    "pretrained": "/shared/jacklishufan/mae/mae_visualize_vit_base.pth",
    "channels_last": true,
    "context_mode": "none",
    "transformer_xl":{
      "no_memory":false,
      "ext_len": 0
    },
    "out_indices":-2,
    "expected_stride":16
  },
  "tiling":"naive",
  "crop_size": 4096,
  "encoder_crop_size":512,
  "multiplier": 64,
  "optimizer": {
    "train_bs": 2,
    "val_bs": 1,
    "type": "AdamW",
    "learning_rate": 5.0e-4,
    "weight_decay": 1e-5,
    "nesterov": true,
    "momentum": 0.9,
    "schedule": {
      "type": "cosine",
      "mode": "step",
      "epochs": 800,
      "params": {
        "eta_min": 4e-6
      },
      "warmup_epoches":40
    }
  },
   "losses": [
    {
      "name": "msk_v",
      "type": "ComboLossCalculator",
      "weight": 1.0,
      "display": true,
      "params": {
        "field": "vessel_mask",
        "weights": {
          "bce": 1,
          "focal": 3,
          "dice": 1
        }
      }
    },
    {
      "name": "msk_f",
      "type": "ComboLossCalculator",
      "weight": 2.0,
      "display": true,
      "params": {
        "field": "fishing_mask",
        "weights": {
          "bce": 1,
          "focal": 3,
          "dice": 1
        }
      }
    },
    {
      "name": "center",
      "type": "CenterLossCalculator",
      "weight": 1e-5,
      "display": true,
      "params": {
      }
    },
    {
      "name": "length",
      "type": "LengthLoss",
      "weight": 0.1,
      "display": true,
      "params": {
      }
    }
   
  ]
}
